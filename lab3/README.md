# Лабораторная работа 3

**Название:** "Разработка драйверов сетевых устройств"

**Цель работы:** Получить знания и навыки разработки драйверов сетевых интерфейсов для операционной системы Linux.

## Описание функциональности драйвера

При загрузке драйвер создает виртуальный сетевой интерфейс, который наследует настройки от интерфейса `lo`.
Драйвер обрабатывает пакеты, имющие IP-адрес получателя 127.0.0.53.
Информация о перехваченных пакетах выводится при чтении файла `/proc/var2data`.
Также информация об обрабатываемых пакетах выводится в кольцевой буфер ядра.

```
[ 3168.569000] Captured IP packet, saddr: 127.0.0.1
[ 3168.569002] daddr: 127.0.0.1
```


## Инструкция по сборке

Выполнить команду:
```
sudo make
```

## Инструкция пользователя

Для загрузки модуля выполнить команду:
```
sudo insmod virt_net_if.ko
```

Проверка кольцевого буфера:
```
dmesg -w
```

Проверка содержимого служебного файла: 
```
cat /proc/var2data
```

Удаления модуля: 
```
sudo rmmod virt_net_if
```

## Примеры использования

Проверить работу драйвера можно командой `ping`.

```bash
$ ping 127.0.0.53

PING 127.0.0.53 (127.0.0.53) 56(84) bytes of data.
64 bytes from 127.0.0.53: icmp_seq=1 ttl=64 time=0.023 ms
64 bytes from 127.0.0.53: icmp_seq=2 ttl=64 time=0.026 ms
64 bytes from 127.0.0.53: icmp_seq=3 ttl=64 time=0.026 ms
64 bytes from 127.0.0.53: icmp_seq=4 ttl=64 time=0.039 ms
^C
--- 127.0.0.53 ping statistics ---

$ cat /proc/var2data
Captured IP packet, saddr: 127.0.0.1
daddr: 127.0.0.53

Captured IP packet, saddr: 127.0.0.1
daddr: 127.0.0.53

Captured IP packet, saddr: 127.0.0.1
daddr: 127.0.0.53

Captured IP packet, saddr: 127.0.0.1
daddr: 127.0.0.53


```
